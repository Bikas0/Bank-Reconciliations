# import json
# from bs4 import BeautifulSoup
# import csv
# from io import StringIO

# # Your JSON data
# data = {
#   "pdf": "DBBL 1113.pdf",
#   "total_pages": 5,
#   "results": {
#     "1.png": "[{\"bbox\": [856, 31, 1143, 73], \"category\": \"Page-header\", \"text\": \"Dutch-Bangla Bank\"}, {\"bbox\": [308, 131, 523, 203], \"category\": \"Text\", \"text\": \"Dutch-Bangla Bank PLC\\nDhanmondi Branch\\n02, Bays Park Height, 09\\nDhanmondi\\nDhanmondi, Dhaka, Bangladesh\"}, {\"bbox\": [101, 237, 438, 308], \"category\": \"Text\", \"text\": \"KAZI FARMS LTD.\\nCORPORATE CENTRE\\nHOUSE#35;ROAD#02,DHANMONDI RESIDENTIAL AREA,\\nDHAKA\\n1205\"}, {\"bbox\": [621, 222, 923, 339], \"category\": \"Text\", \"text\": \"Account Number : 1101200001113\\nPeriod From : 01-JUL-25 - 31-JUL-25\\nPage : 1\\nCurrency Name : Bangladeshi Taka\\nBranch Code : 110\\nCustomer Id : 102961337\\nAccount Type : Savings\\nA/c Open Date : 04-JUL-2011\"}, {\"bbox\": [362, 358, 484, 369], \"category\": \"Section-header\", \"text\": \"ONLINE STATEMENT\"}, {\"bbox\": [101, 387, 997, 1337], \"category\": \"Table\", \"text\": \"<table><thead><tr><th>TRN. DATE</th><th>BRN</th><th>DESCRIPTIONS</th><th>REFERENCES</th><th>DEBITS</th><th>CREDITS</th><th>BALANCE</th></tr></thead><tbody><tr><td>01-JUL-25</td><td></td><td>STATEMENT OPENING BALANCE</td><td></td><td>433,863,663.32</td><td></td><td>433,863,663.32</td></tr><tr><td>01-JUL-25</td><td>100</td><td>NexusPay- Send Money (1661100014186) to 1101200001113</td><td>100NEXP251826759</td><td></td><td>200,000.00</td><td>434,063,663.32</td></tr><tr><td>01-JUL-25</td><td>B31</td><td>CASH DEPOSIT From M/S Lamia Enterprise, KISHOREGANJ, KARIMGANJ, AO-B31011</td><td>B31CDAO251820035</td><td></td><td>11,220.00</td><td>434,074,883.32</td></tr><tr><td>01-JUL-25</td><td>B31</td><td>ONLINE CHARGE FOR AGENT BANKING</td><td>B31CDAO251820035</td><td>22.44</td><td></td><td>434,074,860.88</td></tr><tr><td>01-JUL-25</td><td>100</td><td>NexusPay- Send Money (2311100022316) to 1101200001113</td><td>100NEXP25182AFYI</td><td></td><td>195,800.00</td><td>434,270,660.88</td></tr><tr><td>01-JUL-25</td><td>B49</td><td>CASH DEPOSIT From Mohammad Ali Enterprise, NARSINGDI, SHIBPUR, AO-B49037</td><td>B49CDAO251820003</td><td></td><td>22,400.00</td><td>434,293,060.88</td></tr><tr><td>01-JUL-25</td><td>B49</td><td>ONLINE CHARGE FOR AGENT BANKING</td><td>B49CDAO251820003</td><td>44.80</td><td></td><td>434,293,016.08</td></tr><tr><td>01-JUL-25</td><td>228</td><td>CRM Cash Deposit -at HAMDAH FT CRM-1 JHN</td><td>228ACSD251820042</td><td></td><td>89,500.00</td><td>434,382,516.08</td></tr><tr><td>01-JUL-25</td><td>100</td><td>NexusPay- Send Money (7017512188130) to 1101200001113</td><td>100NEXP25182B6WN</td><td></td><td>13,170.00</td><td>434,395,686.08</td></tr><tr><td>01-JUL-25</td><td>228</td><td>CRM Cash Deposit -at HAMDAH FT CRM-2 JHN</td><td>228ACSD25182006G</td><td></td><td>61,500.00</td><td>434,457,186.08</td></tr><tr><td>01-JUL-25</td><td>100</td><td>NexusPay- Send Money (2311100022823) to 1101200001113</td><td>100NEXP25182BGQ7</td><td></td><td>25,948.00</td><td>434,483,134.08</td></tr><tr><td>01-JUL-25</td><td>121</td><td>CRM Cash Deposit -at JURI FT CRM-1 BOROLEKHA</td><td>121ACSD2518202E8</td><td></td><td>25,000.00</td><td>434,508,134.08</td></tr><tr><td>01-JUL-25</td><td>100</td><td>NexusPay- Send Money (3121100041478) to 1101200001113</td><td>100NEXP25182BXDI</td><td></td><td>7,860.00</td><td>434,515,994.08</td></tr><tr><td>01-JUL-25</td><td>100</td><td>NexusPay- Send Money (7017341662235) to 1101200001113</td><td>100NEXP25182C7F5</td><td></td><td>35,000.00</td><td>434,550,994.08</td></tr><tr><td>01-JUL-25</td><td>100</td><td>NexusPay- Send Money (1361100027000) to 1101200001113</td><td>100NEXP25182CFI7</td><td></td><td>195,000.00</td><td>434,745,994.08</td></tr><tr><td>01-JUL-25</td><td>100</td><td>10000199999999999||518 221812351|Islami Bank Online Dhaka BGD||</td><td>100NPFT251824LMJ</td><td></td><td>11,000.00</td><td>434,756,994.08</td></tr><tr><td>01-JUL-25</td><td>100</td><td>NexusPay- Send Money (1381010188395) to 1101200001113</td><td>100NEXP25182CT99</td><td></td><td>10,900.00</td><td>434,767,894.08</td></tr><tr><td>01-JUL-25</td><td>110</td><td>Standing Instruction | FROM A/C # 1101100011143 for | FUND TRANSFER</td><td>110SWOU241930001</td><td></td><td>329,666.64</td><td>435,097,560.72</td></tr><tr><td>01-JUL-25</td><td>110</td><td>Standing Instruction | FROM A/C # 1101200003265 for | FUND TRANSFER</td><td>110SWOU241930002</td><td></td><td>4,045,774.28</td><td>439,143,335.00</td></tr><tr><td>01-JUL-25</td><td>110</td><td>Standing Instruction | FROM A/C # 1101200003270 for |</td><td>110SWOU241930501</td><td></td><td>137,041.28</td><td>439,280,376.28</td></tr></tbody></table>\"}, {\"bbox\": [101, 1371, 646, 1389], \"category\": \"Text\", \"text\": \"This is a computer generated statement and does not require any signature.\"}]",
#     "2.png": "[{\"bbox\": [856, 31, 1143, 73], \"category\": \"Page-header\", \"text\": \"Dutch-Bangla Bank\"}, {\"bbox\": [308, 101, 523, 173], \"category\": \"Text\", \"text\": \"Dutch-Bangla Bank PLC\\nDhanmondi Branch\\n02, Bays Park Height, 09\\nDhanmondi\\nDhanmondi, Dhaka, Bangladesh\"}, {\"bbox\": [101, 207, 437, 277], \"category\": \"Text\", \"text\": \"KAZI FARMS LTD.\\nCORPORATE CENTRE\\nHOUSE#35;ROAD#02,DHANMONDI RESIDENTIAL AREA,\\nDHAKA\\n1205\"}, {\"bbox\": [621, 191, 922, 309], \"category\": \"Text\", \"text\": \"Account Number : 1101200001113\\nPeriod From : 01-JUL-25 - 31-JUL-25\\nPage : 2\\nCurrency Name : Bangladeshi Taka\\nBranch Code : 110\\nCustomer Id : 102961337\\nAccount Type : Savings\\nA/c Open Date : 04-JUL-2011\"}, {\"bbox\": [362, 327, 484, 338], \"category\": \"Section-header\", \"text\": \"ONLINE STATEMENT\"}, {\"bbox\": [101, 357, 997, 1337], \"category\": \"Table\", \"text\": \"<table><thead><tr><th>TRN. DATE</th><th>BRN</th><th>DESCRIPTIONS</th><th>REFERENCES</th><th>DEBITS</th><th>CREDITS</th><th>BALANCE</th></tr></thead><tbody><tr><td></td><td></td><td>FUND TRANSFER</td><td></td><td></td><td></td><td></td></tr><tr><td>01-JUL-25</td><td>110</td><td>Standing Instruction<br>| FROM A/C #<br>1101200003286 for |</td><td>110SWOU241930003</td><td></td><td>117,602.80</td><td>439,397,979.08</td></tr><tr><td>01-JUL-25</td><td>110</td><td>Standing Instruction<br>| FROM A/C #<br>1101200003291 for |</td><td>110SWOU241931001</td><td></td><td>128.48</td><td>439,398,107.56</td></tr><tr><td></td><td></td><td>FUND TRANSFER</td><td></td><td></td><td></td><td></td></tr><tr><td>01-JUL-25</td><td>110</td><td>Standing Instruction<br>| FROM A/C #<br>1101200003309 for |</td><td>110SWOU241931002</td><td></td><td>128.77</td><td>439,398,236.33</td></tr><tr><td></td><td></td><td>FUND TRANSFER</td><td></td><td></td><td></td><td></td></tr><tr><td>01-JUL-25</td><td>110</td><td>Standing Instruction<br>| FROM A/C #<br>1101200003314 for |</td><td>110SWOU241930005</td><td></td><td>153,127.12</td><td>439,551,363.45</td></tr><tr><td></td><td></td><td>FUND TRANSFER</td><td></td><td></td><td></td><td></td></tr><tr><td>01-JUL-25</td><td>110</td><td>Standing Instruction<br>| FROM A/C #<br>1101200003326 for |</td><td>110SWOU241930004</td><td></td><td>4,156,915.85</td><td>443,708,279.30</td></tr><tr><td>01-JUL-25</td><td>110</td><td>Standing Instruction<br>| FROM A/C #<br>1101200003382 for |</td><td>110SWOU241930502</td><td></td><td>3,717,774.66</td><td>447,426,053.96</td></tr><tr><td></td><td></td><td>FUND TRANSFER</td><td></td><td></td><td></td><td></td></tr><tr><td>02-JUL-25</td><td>110</td><td>Fund Transfer against<br>Cheque# 1963214 From<br>A/C NO 1101200001113<br>To A/C NO<br>107120000645</td><td>110LOCH251830011<br>Instr:1963214</td><td>242,000.00</td><td></td><td>447,184,053.96</td></tr><tr><td>02-JUL-25</td><td>961</td><td>LOAN INSTALLMENT<br>DEDUCTION<br>961AG23251350001</td><td>961AG23251350001</td><td>298,611.11</td><td></td><td>446,885,442.85</td></tr><tr><td>02-JUL-25</td><td>961</td><td>LOAN INSTALLMENT<br>DEDUCTION<br>961AG23251760001</td><td>961AG23251760001</td><td>1,045,138.89</td><td></td><td>445,840,303.96</td></tr><tr><td>02-JUL-25</td><td>100</td><td>1000019999999999||070<br>250004163|IFIC Bank<br>PLC Dhaka<br>BGD||</td><td>100NPFT2518307XN</td><td></td><td>10,000.00</td><td>445,850,303.96</td></tr><tr><td>02-JUL-25</td><td>100</td><td>NexusPay- Send Money<br>(3041100004708) to<br>1101200001113</td><td>100NEXP25183APLH</td><td></td><td>19,360.00</td><td>445,869,663.96</td></tr><tr><td>02-JUL-25</td><td>100</td><td>NexusPay- Send Money<br>(3041100004708) to<br>1101200001113</td><td>100NEXP25183APWS</td><td></td><td>28,000.00</td><td>445,897,663.96</td></tr><tr><td>02-JUL-25</td><td>100</td><td>NexusPay- Send Money<br>(7017100120012) to<br>1101200001113</td><td>100NEXP25183APZM</td><td></td><td>30,000.00</td><td>445,927,663.96</td></tr><tr><td>02-JUL-25</td><td>747</td><td>Inward HV Clearing |<br>Presented by -<br>Standard Chartered<br>Bank | RN: 215270009<br>| CLG Date: 02/07/2025</td><td>747CGIH251830296<br>Instr:8401008</td><td>50,000,000.00</td><td></td><td>395,927,663.96</td></tr><tr><td>02-JUL-25</td><td>747</td><td>Inward HV Clearing |<br>Presented by - Com.<br>Bank of Ceylon | RN:<br>080261180 | CLG Date:<br>02/07/2025</td><td>747CGIH251830297<br>Instr:1963383</td><td>50,000,000.00</td><td></td><td>345,927,663.96</td></tr><tr><td>02-JUL-25</td><td>747</td><td>Inward RV Clearing |<br>Presented by - NCC<br>Bank | RN: 160261189<br>| CLG Date: 02/07/2025</td><td>747CGIN251832766<br>Instr:1963497</td><td>50,000,000.00</td><td></td><td>295,927,663.96</td></tr><tr><td>02-JUL-25</td><td>A25</td><td>CASH DEPOSIT From Ali</td><td>A25CDAO251830292</td><td></td><td>12,024.00</td><td>295,939,687.96</td></tr></tbody></table>\"}, {\"bbox\": [101, 1371, 646, 1389], \"category\": \"Text\", \"text\": \"This is a computer generated statement and does not require any signature.\"}]",
#     "3.png": "[{\"bbox\": [856, 31, 1143, 73], \"category\": \"Page-header\", \"text\": \"Dutch-Bangla Bank\"}, {\"bbox\": [308, 101, 523, 173], \"category\": \"Text\", \"text\": \"Dutch-Bangla Bank PLC\\nDhanmondi Branch\\n02, Bays Park Height, 09\\nDhanmondi\\nDhanmondi, Dhaka, Bangladesh\"}, {\"bbox\": [101, 207, 437, 277], \"category\": \"Text\", \"text\": \"KAZI FARMS LTD.\\nCORPORATE CENTRE\\nHOUSE#35;ROAD#02,DHANMONDI RESIDENTIAL AREA,\\nDHAKA\\n1205\"}, {\"bbox\": [621, 191, 922, 309], \"category\": \"Text\", \"text\": \"Account Number : 1101200001113\\nPeriod From : 01-JUL-25 - 31-JUL-25\\nPage : 3\\nCurrency Name : Bangladeshi Taka\\nBranch Code : 110\\nCustomer Id : 102961337\\nAccount Type : Savings\\nA/c Open Date : 04-JUL-2011\"}, {\"bbox\": [362, 327, 484, 338], \"category\": \"Section-header\", \"text\": \"ONLINE STATEMENT\"}, {\"bbox\": [101, 357, 997, 1337], \"category\": \"Table\", \"text\": \"<table><thead><tr><th>TRN. DATE</th><th>BRN</th><th>DESCRIPTIONS</th><th>REFERENCES</th><th>DEBITS</th><th>CREDITS</th><th>BALANCE</th></tr></thead><tbody><tr><td></td><td></td><td>Ahsan Traders, BOGURA, SHAJAHANPUR, AO-A25098 ONLINE CHARGE FOR AGENT BANKING</td><td>A25CDAO251830292</td><td>24.05</td><td></td><td>295,939,663.91</td></tr><tr><td>02-JUL-25</td><td>A25</td><td>1000019999999999||518 314851073|Islami Bank Online BGD||</td><td>100NPFT251830EQU</td><td></td><td>49,690.00</td><td>295,989,353.91</td></tr><tr><td>02-JUL-25</td><td>110</td><td>Cheque Withdrawal with Cheque# 6007448 Rofikul Islam 01799989797</td><td>110CQWL251830644 Instr:6007448</td><td>248,500.00</td><td></td><td>295,740,853.91</td></tr><tr><td>02-JUL-25</td><td>100</td><td>NexusPay- Send Money (1761100008706) to 1101200001113</td><td>100NEXP25183BJ3K</td><td></td><td>9,900.00</td><td>295,750,753.91</td></tr><tr><td>02-JUL-25</td><td>100</td><td>10000199999999999||518 315858241|Islami Bank Online BGD||</td><td>100NPFT251830JOR</td><td></td><td>12,000.00</td><td>295,762,753.91</td></tr><tr><td>02-JUL-25</td><td>B50</td><td>CASH DEPOSIT From Khokon Enterprise, NOAKHALI, NOAKHALI_SADAR, AO-B500 16</td><td>B50CDAO251830715</td><td></td><td>66,600.00</td><td>295,829,353.91</td></tr><tr><td>02-JUL-25</td><td>B50</td><td>ONLINE CHARGE FOR AGENT BANKING</td><td>B50CDAO251830715</td><td>133.20</td><td></td><td>295,829,220.71</td></tr><tr><td>02-JUL-25</td><td>C39</td><td>FUND TRANSFER[From Account 7017100202901]-From Tisha Telecom Center, NARAYANGANJ, RUPGANJ, AO-C39001</td><td>C39FTA0251830002</td><td></td><td>8,780.00</td><td>295,838,000.71</td></tr><tr><td>02-JUL-25</td><td>G03</td><td>Cash Deposit</td><td>G03CHDP251831015</td><td></td><td>65,000.00</td><td>295,903,000.71</td></tr><tr><td>02-JUL-25</td><td>747</td><td>Outward HV Clearing | Instrument of Rupali Bank | RN: 185261180 | CLG Date: 02/07/2025</td><td>747CGHV251830566 Instr:3935379</td><td></td><td>2,500,000.00</td><td>298,403,000.71</td></tr><tr><td>02-JUL-25</td><td>747</td><td>HIGH VALUE CLG. CHARGE</td><td>747CGHV251830566 Instr:3935379</td><td>50.00</td><td></td><td>298,402,950.71</td></tr><tr><td>02-JUL-25</td><td>747</td><td>HIGH VALUE CLG. CHARGE</td><td>747CGHV251830566 Instr:3935379</td><td>8.69</td><td></td><td>298,402,942.02</td></tr><tr><td>02-JUL-25</td><td>747</td><td>VAT ON SC</td><td>747CGHV251830566 Instr:3935379</td><td>1.31</td><td></td><td>298,402,940.71</td></tr><tr><td>02-JUL-25</td><td>747</td><td>Outward HV Clearing | Instrument of Rupali Bank | RN: 185261180 | CLG Date: 02/07/2025</td><td>747CGHV251830574 Instr:3935377</td><td></td><td>2,500,000.00</td><td>300,902,940.71</td></tr><tr><td>02-JUL-25</td><td>747</td><td>HIGH VALUE CLG. CHARGE</td><td>747CGHV251830574 Instr:3935377</td><td>50.00</td><td></td><td>300,902,890.71</td></tr><tr><td>02-JUL-25</td><td>747</td><td>HIGH VALUE CLG. CHARGE</td><td>747CGHV251830574 Instr:3935377</td><td>8.69</td><td></td><td>300,902,882.02</td></tr><tr><td>02-JUL-25</td><td>747</td><td>VAT ON SC</td><td>747CGHV251830574 Instr:3935377</td><td>1.31</td><td></td><td>300,902,880.71</td></tr><tr><td>02-JUL-25</td><td>747</td><td>Outward HV Clearing | Instrument of Rupali Bank | RN: 185261180 | CLG Date: 02/07/2025</td><td>747CGHV251830581 Instr:3935378</td><td></td><td>2,500,000.00</td><td>303,402,880.71</td></tr><tr><td>02-JUL-25</td><td>747</td><td>HIGH VALUE CLG. CHARGE</td><td>747CGHV251830581 Instr:3935378</td><td>50.00</td><td></td><td>303,402,830.71</td></tr><tr><td>02-JUL-25</td><td>747</td><td>HIGH VALUE CLG. CHARGE</td><td>747CGHV251830581 Instr:3935378</td><td>8.69</td><td></td><td>303,402,822.02</td></tr><tr><td>02-JUL-25</td><td>747</td><td>VAT ON SC</td><td>747CGHV251830581 Instr:3935378</td><td>1.31</td><td></td><td>303,402,820.71</td></tr></tbody></table>\"}, {\"bbox\": [101, 1371, 646, 1389], \"category\": \"Text\", \"text\": \"This is a computer generated statement and does not require any signature.\"}]",
#     "4.png": "[{\"bbox\": [856, 31, 1143, 73], \"category\": \"Page-header\", \"text\": \"Dutch-Bangla Bank\"}, {\"bbox\": [308, 101, 523, 173], \"category\": \"Text\", \"text\": \"Dutch-Bangla Bank PLC\\nDhanmondi Branch\\n02, Bays Park Height, 09\\nDhanmondi\\nDhanmondi, Dhaka, Bangladesh\"}, {\"bbox\": [101, 207, 438, 278], \"category\": \"Text\", \"text\": \"KAZI FARMS LTD.\\nCORPORATE CENTRE\\nHOUSE#35;ROAD#02,DHANMONDI RESIDENTIAL AREA,\\nDHAKA\\n1205\"}, {\"bbox\": [621, 191, 922, 309], \"category\": \"Text\", \"text\": \"Account Number : 1101200001113\\nPeriod From : 01-JUL-25 - 31-JUL-25\\nPage : 4\\nCurrency Name : Bangladeshi Taka\\nBranch Code : 110\\nCustomer Id : 102961337\\nAccount Type : Savings\\nA/c Open Date : 04-JUL-2011\"}, {\"bbox\": [362, 327, 484, 338], \"category\": \"Section-header\", \"text\": \"ONLINE STATEMENT\"}, {\"bbox\": [101, 357, 997, 1322], \"category\": \"Table\", \"text\": \"<table><thead><tr><th>TRN. DATE</th><th>BRN</th><th>DESCRIPTIONS</th><th>REFERENCES</th><th>DEBITS</th><th>CREDITS</th><th>BALANCE</th></tr></thead><tbody><tr><td>02-JUL-25</td><td>100</td><td>1000019999999999||518<br>318869950|Islami Bank<br>Online Dhaka<br>BGD||</td><td>100NPFT251830S3Z</td><td></td><td>11,000.00</td><td>303,413,820.71</td></tr><tr><td>02-JUL-25</td><td>110</td><td>KFL FINAL PAYMENT</td><td>1101102251830397</td><td>495,856.00</td><td></td><td>302,917,964.71</td></tr><tr><td>02-JUL-25</td><td>110</td><td>Standing Instruction<br>| FROM A/C #<br>1101100011143 for |<br>FUND TRANSFER</td><td>110SWOU241930001</td><td></td><td>578,933.00</td><td>303,496,897.71</td></tr><tr><td>02-JUL-25</td><td>110</td><td>Standing Instruction<br>| FROM A/C #<br>1101200003265 for |<br>FUND TRANSFER</td><td>110SWOU241930002</td><td></td><td>4,467,505.01</td><td>307,964,402.72</td></tr><tr><td>02-JUL-25</td><td>110</td><td>Standing Instruction<br>| FROM A/C #<br>1101200003270 for |<br>FUND TRANSFER</td><td>110SWOU241930501</td><td></td><td>1,276,949.96</td><td>309,241,352.68</td></tr><tr><td>02-JUL-25</td><td>110</td><td>Standing Instruction<br>| FROM A/C #<br>1101200003286 for |<br>FUND TRANSFER</td><td>110SWOU241930003</td><td></td><td>96,383.20</td><td>309,337,735.88</td></tr><tr><td>02-JUL-25</td><td>110</td><td>Standing Instruction<br>| FROM A/C #<br>1101200003291 for |<br>FUND TRANSFER</td><td>110SWOU241931001</td><td></td><td>165,000.00</td><td>309,502,735.88</td></tr><tr><td>02-JUL-25</td><td>110</td><td>Standing Instruction<br>| FROM A/C #<br>1101200003314 for |<br>FUND TRANSFER</td><td>110SWOU241930005</td><td></td><td>256,965.00</td><td>309,759,700.88</td></tr><tr><td>02-JUL-25</td><td>110</td><td>Standing Instruction<br>| FROM A/C #<br>1101200003326 for |<br>FUND TRANSFER</td><td>110SWOU241930004</td><td></td><td>7,069,547.41</td><td>316,829,248.29</td></tr><tr><td>02-JUL-25</td><td>110</td><td>Standing Instruction<br>| FROM A/C #<br>1101200003382 for |<br>FUND TRANSFER</td><td>110SWOU241930502</td><td></td><td>13,517,595.02</td><td>330,346,843.31</td></tr><tr><td>03-JUL-25</td><td>110</td><td>Fund Transfer against<br>Cheque# 1963220 From<br>A/C NO 1101200001113<br>To A/C NO<br>1281100034913</td><td>110LOCH251841001<br>Instr:1963220</td><td>201,599.00</td><td></td><td>330,145,244.31</td></tr><tr><td>03-JUL-25</td><td>110</td><td>Fund Transfer against<br>Cheque# 1963221 From<br>A/C NO 1101200001113<br>To A/C NO<br>1281100034913</td><td>110LOCH251841002<br>Instr:1963221</td><td>246,299.00</td><td></td><td>329,898,945.31</td></tr><tr><td>03-JUL-25</td><td>103</td><td>CRM Cash Deposit -at<br>BUS STND FT CRM-6<br>HEPAYET</td><td>103ACSD2518401AB</td><td></td><td>16,000.00</td><td>329,914,945.31</td></tr><tr><td>03-JUL-25</td><td>751</td><td>Fund Transfer_ KAZI<br>FARMS LTD.</td><td>7517510251840002</td><td>13,130,000.00</td><td></td><td>316,784,945.31</td></tr><tr><td>03-JUL-25</td><td>230</td><td>Fund Transfer against<br>Cheque# 9771963 From<br>A/C NO 2301100002429<br>To A/C NO<br>1101200001113</td><td>230LOCH251840010<br>Instr:9771963</td><td></td><td>33,300.00</td><td>316,818,245.31</td></tr><tr><td>03-JUL-25</td><td>110</td><td>Fund Transfer against<br>Cheque# 1963215 From<br>A/C NO 1101200001113<br>To A/C NO<br>2131100030631</td><td>110LOCH251841008<br>Instr:1963215</td><td>92,249.00</td><td></td><td>316,725,996.31</td></tr><tr><td>03-JUL-25</td><td>110</td><td>Fund Transfer against<br>Cheque# 1963215 From<br>A/C NO 1101200001113<br>To A/C NO<br>2131100030631</td><td>110LOCH251840042<br>Instr:1963215</td><td>21,734.00</td><td></td><td>316,704,262.31</td></tr></tbody></table>\"}, {\"bbox\": [101, 1371, 646, 1389], \"category\": \"Page-footer\", \"text\": \"This is a computer generated statement and does not require any signature.\"}]",
#     "5.png": "[{\"bbox\": [856, 31, 1143, 73], \"category\": \"Page-header\", \"text\": \"Dutch-Bangla Bank\"}, {\"bbox\": [307, 85, 524, 159], \"category\": \"Text\", \"text\": \"Dutch-Bangla Bank PLC\\nDhanmondi Branch\\n02, Bays Park Height, 09\\nDhanmondi\\nDhanmondi, Dhaka, Bangladesh\"}, {\"bbox\": [101, 191, 439, 263], \"category\": \"Text\", \"text\": \"KAZI FARMS LTD.\\nCORPORATE CENTRE\\nHOUSE#35;ROAD#02,DHANMONDI RESIDENTIAL AREA,\\nDHAKA\\n1205\"}, {\"bbox\": [621, 175, 923, 294], \"category\": \"Text\", \"text\": \"Account Number : 1101200001113\\nPeriod From : 01-JUL-25 - 31-JUL-25\\nPage : 5\\nCurrency Name : Bangladeshi Taka\\nBranch Code : 110\\nCustomer Id : 102961337\\nAccount Type : Savings\\nA/c Open Date : 04-JUL-2011\"}, {\"bbox\": [362, 312, 484, 323], \"category\": \"Section-header\", \"text\": \"ONLINE STATEMENT\"}, {\"bbox\": [101, 342, 997, 1321], \"category\": \"Table\", \"text\": \"<table><thead><tr><th>TRN. DATE</th><th>BRN</th><th>DESCRIPTIONS</th><th>REFERENCES</th><th>DEBITS</th><th>CREDITS</th><th>BALANCE</th></tr></thead><tbody><tr><td></td><td></td><td>Cheque# 1963216 From A/C NO 1101200001113 To A/C NO 1281100034913</td><td>Instr:1963216</td><td></td><td></td><td></td></tr><tr><td>03-JUL-25</td><td>100</td><td>NexusPay- Send Money (1661100014186) to 1101200001113</td><td>100NEXP25184BBLX</td><td></td><td>200,000.00</td><td>316,904,262.31</td></tr><tr><td>03-JUL-25</td><td>100</td><td>NexusPay- Send Money (1991030445489) to 1101200001113</td><td>100NEXP25184BCM1</td><td></td><td>7,200.00</td><td>316,911,462.31</td></tr><tr><td>03-JUL-25</td><td>100</td><td>NexusPay- Send Money (1991030445489) to 1101200001113</td><td>100NEXP25184BCSK</td><td></td><td>7,200.00</td><td>316,918,662.31</td></tr><tr><td>03-JUL-25</td><td>339</td><td>CRM Cash Deposit -at MURAPARA BR CRM-2</td><td>339ACSD2518400E0</td><td></td><td>16,500.00</td><td>316,935,162.31</td></tr><tr><td>03-JUL-25</td><td>110</td><td>Fund Transfer against Cheque# 1963222 From A/C NO 1101200001113 To A/C NO 2131100030631</td><td>110LOCH251840053 Instr:1963222</td><td>166,049.00</td><td></td><td>316,769,113.31</td></tr><tr><td>03-JUL-25</td><td>110</td><td>Fund Transfer against Cheque# 1963219 From A/C NO 1101200001113 To A/C NO 1281100029558</td><td>110LOCH251840056 Instr:1963219</td><td>10,464.00</td><td></td><td>316,758,649.31</td></tr><tr><td>03-JUL-25</td><td>110</td><td>Fund Transfer against Cheque# 1963218 From A/C NO 1101200001113 To A/C NO 1281100029558</td><td>110LOCH251840057 Instr:1963218</td><td>31,394.00</td><td></td><td>316,727,255.31</td></tr><tr><td>03-JUL-25</td><td>110</td><td>Fund Transfer against Cheque# 1963217 From A/C NO 1101200001113 To A/C NO 1281100029558</td><td>110LOCH251840058 Instr:1963217</td><td>10,464.00</td><td></td><td>316,716,791.31</td></tr><tr><td>03-JUL-25</td><td>100</td><td>NexusPay- Send Money (7017416576353) to 1101200001113</td><td>100NEXP25184C2RA</td><td></td><td>50,000.00</td><td>316,766,791.31</td></tr><tr><td>03-JUL-25</td><td>120</td><td>CRM Cash Deposit -at RAMPAL FT CRM-2 BAGERHAT</td><td>120ACSD2518400QF</td><td></td><td>50,000.00</td><td>316,816,791.31</td></tr><tr><td>03-JUL-25</td><td>H99</td><td>Fund Transfer against Cheque# 6683481 From A/C NO 2311100203751 To A/C NO 1101200001113</td><td>H99LOCH251840504 Instr:6683481</td><td></td><td>61,000.00</td><td>316,877,791.31</td></tr><tr><td>03-JUL-25</td><td>100</td><td>NexusPay- Send Money (2621100024569) to 1101200001113</td><td>100NEXP25184CCRU</td><td></td><td>25,000.00</td><td>316,902,791.31</td></tr><tr><td>03-JUL-25</td><td>110</td><td>FUND TRANSFER</td><td>1108002251840001</td><td>180,000.00</td><td></td><td>316,722,791.31</td></tr><tr><td>03-JUL-25</td><td>B50</td><td>CASH DEPOSIT From Khokon Enterprise,NOAKHALI, NOAKHALI_SADAR, AO-B500 16</td><td>B50CDA0251840705</td><td></td><td>40,000.00</td><td>316,762,791.31</td></tr><tr><td>03-JUL-25</td><td>B50</td><td>ONLINE CHARGE FOR AGENT BANKING</td><td>B50CDA0251840705</td><td>80.00</td><td></td><td>316,762,711.31</td></tr><tr><td>03-JUL-25</td><td>100</td><td>NexusPay- Send Money (1101030400636) to 1101200001113</td><td>100NEXP25184COIQ</td><td></td><td>26.00</td><td>316,762,737.31</td></tr><tr><td>03-JUL-25</td><td>100</td><td>NexusPay- Send Money (1361100027000) to 1101200001113</td><td>100NEXP25184CPZL</td><td></td><td>112,000.00</td><td>316,874,737.31</td></tr></tbody></table>\"}, {\"bbox\": [101, 1371, 646, 1389], \"category\": \"Page-footer\", \"text\": \"This is a computer generated statement and does not require any signature.\"}]"
#   },
#   "status": "done",
#   "started_at": "2025-08-19T05:31:46.398598",
#   "completed_at": "2025-08-19T05:33:08.091165",
#   "processing_duration_seconds": 81.69,
#   "message": "Successfully processed 5 pages from DBBL 1113.pdf in 81.69 seconds"
# }

# # Initialize CSV writer
# output = StringIO()
# csv_writer = csv.writer(output)
# headers_written = False

# # Process each page
# for page_num, page_data in data['results'].items():
#     page_content = json.loads(page_data)
    
#     for item in page_content:
#         if item['category'] == 'Table':
#             soup = BeautifulSoup(item['text'], 'html.parser')
#             table = soup.find('table')
            
#             # Get headers if not already written
#             if not headers_written and table:
#                 headers = [th.get_text(strip=True) for th in table.find('thead').find_all('th')]
#                 csv_writer.writerow(headers)
#                 headers_written = True
            
#             # Write rows
#             if table:
#                 for row in table.find('tbody').find_all('tr'):
#                     row_data = [td.get_text(strip=True) for td in row.find_all('td')]
#                     csv_writer.writerow(row_data)

# # Get the CSV content
# csv_content = output.getvalue()

# # Save to a CSV file
# output_filename = "output.csv"  # You can change this to your desired filename
# with open(output_filename, 'w', newline='', encoding='utf-8') as csv_file:
#     csv_file.write(csv_content)

# print(f"CSV file has been saved as {output_filename}")

import json
from bs4 import BeautifulSoup
import csv
from io import StringIO
import os
import glob

def process_bank_statement_json_to_csv(input_directory):
    """
    Process a bank statement JSON file in the input directory and extract table data to a CSV file
    in the same directory with the same name but .csv extension.
    
    Args:
        input_directory (str): Path to the directory containing the JSON file
    """
    # Find the JSON file in the directory
    json_files = glob.glob(os.path.join(input_directory, '*.json'))
    
    if not json_files:
        print(f"No JSON files found in directory: {input_directory}")
        return
    
    if len(json_files) > 1:
        print(f"Multiple JSON files found in directory. Using the first one: {json_files[0]}")
    
    json_file_path = json_files[0]
    output_csv_path = os.path.splitext(json_file_path)[0] + '.csv'
    
    # Read the JSON data from the file
    try:
        with open(json_file_path, 'r', encoding='utf-8') as json_file:
            data = json.load(json_file)
    except Exception as e:
        print(f"Error reading JSON file: {e}")
        return

    # Initialize CSV writer
    output = StringIO()
    csv_writer = csv.writer(output)
    headers_written = False

    # Process each page
    for page_num, page_data in data['results'].items():
        try:
            page_content = json.loads(page_data)
            
            for item in page_content:
                if item['category'] == 'Table':
                    soup = BeautifulSoup(item['text'], 'html.parser')
                    table = soup.find('table')
                    
                    # Get headers if not already written
                    if not headers_written and table:
                        headers = [th.get_text(strip=True) for th in table.find('thead').find_all('th')]
                        csv_writer.writerow(headers)
                        headers_written = True
                    
                    # Write rows
                    if table:
                        for row in table.find('tbody').find_all('tr'):
                            row_data = [td.get_text(strip=True) for td in row.find_all('td')]
                            csv_writer.writerow(row_data)
        except Exception as e:
            print(f"Error processing page {page_num}: {e}")
            continue

    # Get the CSV content and save to file
    csv_content = output.getvalue()
    try:
        with open(output_csv_path, 'w', newline='', encoding='utf-8') as csv_file:
            csv_file.write(csv_content)
        print(f"Successfully saved extracted table data to {output_csv_path}")
    except Exception as e:
        print(f"Error saving output CSV file: {e}")

# Example usage:
# input_directory = 'output'  # Replace with your directory path
# process_bank_statement_json_to_csv(input_directory)